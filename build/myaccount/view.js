document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("open-login-modal"),t=document.getElementById("open-my-account-modal-btn"),o=document.getElementById("auth-modal"),n=document.getElementById("forgot-password-modal"),s=document.getElementById("my-account-modal"),a=[o,n,s],d=document.getElementById("login-form-wrapper"),r=document.getElementById("signup-form-wrapper"),c=document.getElementById("show-signup"),l=document.getElementById("show-login"),m=document.getElementById("show-forgot-password"),i=document.getElementById("forgot-to-login"),u=document.getElementById("login-form"),g=document.getElementById("signup-form"),y=document.getElementById("forgot-password-form"),f=document.querySelector(".logout-btn"),E=document.getElementById("login-message"),h=document.getElementById("signup-message"),p=document.getElementById("forgot-password-message"),v=e=>{a.forEach(t=>{t!==e&&L(t)}),e.classList.remove("is-hidden"),e.classList.add("is-visible")},L=e=>{e.classList.remove("is-visible"),e.classList.add("is-hidden")},b=(e,t,o="error")=>{if(!e)return void console.error("Message element not found");const n=t.replace(/<[^>]*>/g,"");e.textContent=n,e.className=`form-message ${o}`,"error"===o?(e.style.color="#dc2626",e.style.backgroundColor="#fef2f2",e.style.border="1px solid #fecaca"):"success"===o&&(e.style.color="#059669",e.style.backgroundColor="#f0fdf4",e.style.border="1px solid #bbf7d0"),e.style.display="block"};e&&e.addEventListener("click",()=>v(o)),t&&t.addEventListener("click",()=>v(s)),document.querySelectorAll(".close-modal").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.closest(".modal-container");t&&L(t)})}),c&&c.addEventListener("click",e=>{e.preventDefault(),d.classList.add("hidden"),r.classList.remove("hidden")}),l&&l.addEventListener("click",e=>{e.preventDefault(),r.classList.add("hidden"),d.classList.remove("hidden")}),m&&m.addEventListener("click",e=>{e.preventDefault(),L(o),setTimeout(()=>v(n),300)}),i&&i.addEventListener("click",e=>{e.preventDefault(),L(n),setTimeout(()=>v(o),300)}),document.querySelectorAll(".modal-container").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&L(e)})}),u.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(u);fetch(bazo_myaccount_ajax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?(b(E,e.data.message,"success"),setTimeout(()=>{window.location.reload()},1e3)):b(E,e.data,"error")}).catch(e=>{b(E,"An error occurred. Please try again.","error")})}),g.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(g);t.get("user_password")===t.get("confirm_password")?fetch(bazo_myaccount_ajax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?(b(h,e.data.message,"success"),setTimeout(()=>{window.location.reload()},1e3)):b(h,e.data,"error")}).catch(e=>{b(h,"An error occurred. Please try again.","error")}):b(h,"Passwords do not match.","error")}),y.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(y);fetch(bazo_myaccount_ajax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?b(p,e.data.message,"success"):b(p,e.data,"error")}).catch(e=>{b(p,"An error occurred. Please try again.","error")})}),f&&f.addEventListener("click",e=>{e.preventDefault(),window.location.href=bazo_myaccount_ajax.logoutUrl})});