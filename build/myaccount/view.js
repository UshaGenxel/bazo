document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("open-login-modal"),t=document.getElementById("open-my-account-modal-btn"),o=document.getElementById("auth-modal"),n=document.getElementById("forgot-password-modal"),d=document.getElementById("my-account-modal"),r=document.getElementById("verification-modal"),s=[o,n,d,r],a=document.getElementById("login-form-wrapper"),c=document.getElementById("signup-form-wrapper"),l=document.getElementById("show-signup"),m=document.getElementById("show-login"),i=document.getElementById("show-forgot-password"),u=document.getElementById("forgot-to-login"),g=document.getElementById("login-form"),y=document.getElementById("signup-form"),f=document.getElementById("forgot-password-form"),E=document.querySelector(".logout-btn"),h=document.getElementById("login-message"),v=document.getElementById("signup-message"),p=document.getElementById("forgot-password-message"),L=e=>{s.forEach(t=>{t!==e&&b(t)}),e.classList.remove("is-hidden"),e.classList.add("is-visible")},b=e=>{e.classList.remove("is-visible"),e.classList.add("is-hidden")},w=(e,t,o="error")=>{if(!e)return void console.error("Message element not found");const n=t.replace(/<[^>]*>/g,"");e.textContent=n,e.className=`form-message ${o}`,"error"===o?(e.style.color="#dc2626",e.style.backgroundColor="#fef2f2",e.style.border="1px solid #fecaca"):"success"===o&&(e.style.color="#059669",e.style.backgroundColor="#f0fdf4",e.style.border="1px solid #bbf7d0"),e.style.display="block"};e&&e.addEventListener("click",()=>L(o)),t&&t.addEventListener("click",()=>L(d)),document.querySelectorAll(".close-modal").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.closest(".modal-container");t&&b(t)})}),l&&l.addEventListener("click",e=>{e.preventDefault(),a.classList.add("hidden"),c.classList.remove("hidden")}),m&&m.addEventListener("click",e=>{e.preventDefault(),c.classList.add("hidden"),a.classList.remove("hidden")}),i&&i.addEventListener("click",e=>{e.preventDefault(),b(o),setTimeout(()=>L(n),300)}),u&&u.addEventListener("click",e=>{e.preventDefault(),b(n),setTimeout(()=>L(o),300)}),document.querySelectorAll(".modal-container").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&b(e)})}),g.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(g);fetch(bazo_myaccount_ajax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?(w(h,e.data.message,"success"),setTimeout(()=>{window.location.reload()},1e3)):w(h,e.data,"error")}).catch(e=>{w(h,"An error occurred. Please try again.","error")})}),y.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(y);t.get("user_password")===t.get("confirm_password")?fetch(bazo_myaccount_ajax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?(b(o),setTimeout(()=>L(r),300)):w(v,e.data,"error")}).catch(e=>{w(v,"An error occurred. Please try again.","error")}):w(v,"Passwords do not match.","error")}),f.addEventListener("submit",e=>{e.preventDefault();const t=new FormData(f);fetch(bazo_myaccount_ajax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?w(p,e.data.message,"success"):w(p,e.data,"error")}).catch(e=>{w(p,"An error occurred. Please try again.","error")})}),E&&E.addEventListener("click",e=>{e.preventDefault(),window.location.href=bazo_myaccount_ajax.logoutUrl})});