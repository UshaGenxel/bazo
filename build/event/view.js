document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".wp-block-bazo-event-grid").forEach(e=>{const t=e.querySelector(".bazo-event-grid"),n=e.querySelector(".bazo-event-load-more"),a=e.querySelector(".bazo-load-more-button"),r=e.querySelectorAll(".bazo-event-filter-button"),o=e.querySelector(".bazo-event-filter-icon-button"),c=e.querySelector(".bazo-event-filters");let d=1;const i=e.getAttribute("data-posts-to-show"),s=e.getAttribute("data-post-type"),l=e.getAttribute("data-taxonomy");let v=JSON.parse(e.getAttribute("data-selected-categories")||"[]"),u=n?parseInt(n.getAttribute("data-max-pages")):1;function b(){a&&(a.style.display=d>=u?"none":"block")}function p(e=!1){let n=`/bazo/wp-json/wp/v2/${s}?per_page=${i}&page=${d}`;v.length&&(n+=`&${l}=${v.join(",")}`),fetch(n).then(e=>(u=e.headers.get("X-WP-TotalPages")?parseInt(e.headers.get("X-WP-TotalPages")):1,e.json())).then(n=>{e&&(t.innerHTML=""),console.log("Fetched data:",n),0===n.length?e&&(t.innerHTML="<p>No events found.</p>"):n.forEach(e=>{const n=document.createElement("div");n.className="bazo-event-card",n.innerHTML=`\n                                <a href="${e.link}">\n                                    ${e.featured_media_url?`<div class="bazo-event-card-image"><img src="${e.featured_media_url}" alt=""/></div>`:""}\n                                    <div class="bazo-event-card-content">\n                                        <h3>${e.title.rendered}</h3>\n                                        <p class="bazo-event-card-date">${e.event_date?e.event_date:""}</p>\n                                        <div class="bazo-event-card-excerpt">${e.excerpt&&e.excerpt.rendered?e.excerpt.rendered:""}</div>\n                                    </div>\n                                </a>\n                            `,t.appendChild(n)}),b()}).catch(e=>console.error("Error fetching events:",e))}b(),a&&a.addEventListener("click",function(){d++,p()}),o&&c&&o.addEventListener("click",function(){c.classList.toggle("is-visible")}),r.forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-term");r.forEach(e=>e.classList.remove("active")),this.classList.add("active"),v="all"===e?[]:[parseInt(e)],d=1,p(!0)})})})});